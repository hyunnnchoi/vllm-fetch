(Worker_TP0 pid=187612)
(Worker_TP0 pid=187612) INFO 01-08 14:42:10 [default_loader.py:308] Loading weights took 17.27 seconds
(Worker_TP0 pid=187612) INFO 01-08 14:42:10 [gpu_model_runner.py:3659] Model loading took 32.8894 GiB memory and 18.014233 seconds
(Worker_TP0 pid=187612) INFO 01-08 14:42:26 [backends.py:643] Using cache directory: /home/work/.cache/vllm/torch_compile_cache/20fdf814fb/rank_0_0/backbone for vLLM's torch.compile
(Worker_TP0 pid=187612) INFO 01-08 14:42:26 [backends.py:703] Dynamo bytecode transform time: 15.74 s
(Worker_TP0 pid=187612) INFO 01-08 14:42:40 [backends.py:226] Directly load the compiled graph(s) for compile range (1, 2048) from the cache, took 4.394 s
(Worker_TP0 pid=187612) INFO 01-08 14:42:40 [monitor.py:34] torch.compile takes 20.13 s in total
(Worker_TP2 pid=187614) INFO 01-08 14:42:40 [backends.py:226] Directly load the compiled graph(s) for compile range (1, 2048) from the cache, took 4.539 s
(Worker_TP1 pid=187613) INFO 01-08 14:42:40 [backends.py:226] Directly load the compiled graph(s) for compile range (1, 2048) from the cache, took 4.433 s
(Worker_TP3 pid=187615) INFO 01-08 14:42:40 [backends.py:226] Directly load the compiled graph(s) for compile range (1, 2048) from the cache, took 4.497 s
(Worker_TP0 pid=187612) INFO 01-08 14:42:41 [gpu_worker.py:375] Available KV cache memory: 37.16 GiB
(EngineCore_DP0 pid=187510) INFO 01-08 14:42:42 [kv_cache_utils.py:1291] GPU KV cache size: 486,896 tokens
(EngineCore_DP0 pid=187510) INFO 01-08 14:42:42 [kv_cache_utils.py:1296] Maximum concurrency for 32,768 tokens per request: 14.86x
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|██████████| 51/51 [00:18<00:00,  2.77it/s]
Capturing CUDA graphs (decode, FULL): 100%|██████████| 35/35 [00:08<00:00,  3.92it/s]
(Worker_TP0 pid=187612) INFO 01-08 14:43:10 [gpu_model_runner.py:4587] Graph capturing finished in 28 secs, took 2.94 GiB
(EngineCore_DP0 pid=187510) INFO 01-08 14:43:10 [core.py:259] init engine (profile, create kv cache, warmup model) took 59.92 seconds
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866]   File "/vllm/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866]   File "/vllm/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866]   File "/vllm/vllm/v1/engine/core.py", line 135, in __init__
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866]     self.scheduler: SchedulerInterface = Scheduler(
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866]                                          ^^^^^^^^^^
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:11 [core.py:866] TypeError: Scheduler.__init__() got an unexpected keyword argument 'block_size'
(EngineCore_DP0 pid=187510) ERROR 01-08 14:43:14 [multiproc_executor.py:231] Worker proc VllmWorker-0 died unexpectedly, shutting down executor.
(EngineCore_DP0 pid=187510) Process EngineCore_DP0:
(EngineCore_DP0 pid=187510) Traceback (most recent call last):
(EngineCore_DP0 pid=187510)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=187510)     self.run()
(EngineCore_DP0 pid=187510)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=187510)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=187510)   File "/vllm/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=187510)     raise e
(EngineCore_DP0 pid=187510)   File "/vllm/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=187510)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=187510)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=187510)   File "/vllm/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=187510)     super().__init__(
(EngineCore_DP0 pid=187510)   File "/vllm/vllm/v1/engine/core.py", line 135, in __init__
(EngineCore_DP0 pid=187510)     self.scheduler: SchedulerInterface = Scheduler(
(EngineCore_DP0 pid=187510)                                          ^^^^^^^^^^
(EngineCore_DP0 pid=187510) TypeError: Scheduler.__init__() got an unexpected keyword argument 'block_size'
(APIServer pid=187355) Traceback (most recent call last):
(APIServer pid=187355)   File "/usr/local/bin/vllm", line 7, in <module>
(APIServer pid=187355)     sys.exit(main())
(APIServer pid=187355)              ^^^^^^
(APIServer pid=187355)   File "/vllm/vllm/entrypoints/cli/main.py", line 73, in main
(APIServer pid=187355)     args.dispatch_function(args)
(APIServer pid=187355)   File "/vllm/vllm/entrypoints/cli/serve.py", line 60, in cmd
(APIServer pid=187355)     uvloop.run(run_server(args))
(APIServer pid=187355)   File "/usr/local/lib/python3.12/dist-packages/uvloop/__init__.py", line 96, in run
(APIServer pid=187355)     return __asyncio.run(
(APIServer pid=187355)            ^^^^^^^^^^^^^^
(APIServer pid=187355)   File "/usr/lib/python3.12/asyncio/runners.py", line 195, in run
(APIServer pid=187355)     return runner.run(main)
(APIServer pid=187355)            ^^^^^^^^^^^^^^^^
(APIServer pid=187355)   File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
(APIServer pid=187355)     return self._loop.run_until_complete(task)
(APIServer pid=187355)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(APIServer pid=187355)   File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
(APIServer pid=187355)   File "/usr/local/lib/python3.12/dist-packages/uvloop/__init__.py", line 48, in wrapper
(APIServer pid=187355)     return await main
(APIServer pid=187355)            ^^^^^^^^^^
(APIServer pid=187355)   File "/vllm/vllm/entrypoints/openai/api_server.py", line 1398, in run_server
(APIServer pid=187355)     await run_server_worker(listen_address, sock, args, **uvicorn_kwargs)
(APIServer pid=187355)   File "/vllm/vllm/entrypoints/openai/api_server.py", line 1417, in run_server_worker
(APIServer pid=187355)     async with build_async_engine_client(
(APIServer pid=187355)                ^^^^^^^^^^^^^^^^^^^^^^^^^^
(APIServer pid=187355)   File "/usr/lib/python3.12/contextlib.py", line 210, in __aenter__
(APIServer pid=187355)     return await anext(self.gen)
(APIServer pid=187355)            ^^^^^^^^^^^^^^^^^^^^^
(APIServer pid=187355)   File "/vllm/vllm/entrypoints/openai/api_server.py", line 172, in build_async_engine_client
(APIServer pid=187355)     async with build_async_engine_client_from_engine_args(
(APIServer pid=187355)                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(APIServer pid=187355)   File "/usr/lib/python3.12/contextlib.py", line 210, in __aenter__
(APIServer pid=187355)     return await anext(self.gen)
(APIServer pid=187355)            ^^^^^^^^^^^^^^^^^^^^^
(APIServer pid=187355)   File "/vllm/vllm/entrypoints/openai/api_server.py", line 213, in build_async_engine_client_from_engine_args
(APIServer pid=187355)     async_llm = AsyncLLM.from_vllm_config(
(APIServer pid=187355)                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
(APIServer pid=187355)   File "/vllm/vllm/v1/engine/async_llm.py", line 215, in from_vllm_config
(APIServer pid=187355)     return cls(
(APIServer pid=187355)            ^^^^
(APIServer pid=187355)   File "/vllm/vllm/v1/engine/async_llm.py", line 134, in __init__
(APIServer pid=187355)     self.engine_core = EngineCoreClient.make_async_mp_client(
(APIServer pid=187355)                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(APIServer pid=187355)   File "/vllm/vllm/v1/engine/core_client.py", line 121, in make_async_mp_client
(APIServer pid=187355)     return AsyncMPClient(*client_args)
(APIServer pid=187355)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(APIServer pid=187355)   File "/vllm/vllm/v1/engine/core_client.py", line 820, in __init__
(APIServer pid=187355)     super().__init__(
(APIServer pid=187355)   File "/vllm/vllm/v1/engine/core_client.py", line 477, in __init__
(APIServer pid=187355)     with launch_core_engines(vllm_config, executor_class, log_stats) as (
(APIServer pid=187355)          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(APIServer pid=187355)   File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
(APIServer pid=187355)     next(self.gen)
(APIServer pid=187355)   File "/vllm/vllm/v1/engine/utils.py", line 903, in launch_core_engines
(APIServer pid=187355)     wait_for_engine_startup(
(APIServer pid=187355)   File "/vllm/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
(APIServer pid=187355)     raise RuntimeError(
(APIServer pid=187355) RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s)
